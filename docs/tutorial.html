
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Getting started with dstream_excel &#8212; dstream_excel 0.3.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dstream_excel" href="api/modules.html" />
    <link rel="prev" title="Welcome to Datastream Python Excel Downloader Documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="getting-started-with-dstream-excel">
<span id="tutorial"></span><h1>Getting started with dstream_excel<a class="headerlink" href="#getting-started-with-dstream-excel" title="Permalink to this headline">¶</a></h1>
<div class="section" id="install">
<h2>Install<a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h2>
<p>Install this package via:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">dstream_excel</span>
</pre></div>
</div>
<p>You must also be running Windows, have Excel installed, have Eikon installed,
and have the Eikon plugin for Excel installed.</p>
<p>There is one setting in the Excel plugin that makes or breaks this
automation. Go to the Thompson Reuters Datatream tab, click Options.
In Calculation Options, make sure “Suppress Auto Calculation on Open”
is unchecked.</p>
<p>Also ensure that when you go to the Thomson Reuters and Thomson Reuters Datastream
tabs, that the buttons are not grayed out. If they are, you have to go
to the Thompson Reuters tab and click the “Offline” button. This should
launch Eikon on your system and possibly require you to log in. It may
be necessary to click the “Offline” button again after that. Once you are
logged in, all the buttons should be highlighted on both tabs. Then you can
close Excel and begin using <code class="code docutils literal notranslate"><span class="pre">dstream_excel</span></code>.</p>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This package downloads the data in three main steps:</p>
<p>1. Creates an XLSX workbook for each company containing the Excel function
for the Eikon Excel plugin to download the Datastream data</p>
<p>2. Opens each workbook, one by one, allowing the data to populate, then
closing and saving the workbook.</p>
<p>3. Reads the data from all the generated workbooks and combines into
one CSV file.</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>There are four main functions in the package.
<a class="reference internal" href="api/dstream_excel.html#dstream_excel.main.download_datastream" title="dstream_excel.main.download_datastream"><code class="xref py py-func docutils literal notranslate"><span class="pre">download_datastream()</span></code></a> is the main function, which
is just a wrapper to call the other three main functions which complete
the three steps described above: <a class="reference internal" href="api/dstream_excel.dstream.workbook.html#dstream_excel.dstream.workbook.create.create_all_xlsx_with_datastream_command" title="dstream_excel.dstream.workbook.create.create_all_xlsx_with_datastream_command"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_all_xlsx_with_datastream_command()</span></code></a>,
<a class="reference internal" href="api/dstream_excel.dstream.html#dstream_excel.dstream.downloader.populate_all_files_in_folder" title="dstream_excel.dstream.downloader.populate_all_files_in_folder"><code class="xref py py-func docutils literal notranslate"><span class="pre">populate_all_files_in_folder()</span></code></a>, and <a class="reference internal" href="api/dstream_excel.dstream.html#dstream_excel.dstream.combine.combine_all_datastream_xlsx" title="dstream_excel.dstream.combine.combine_all_datastream_xlsx"><code class="xref py py-func docutils literal notranslate"><span class="pre">combine_all_datastream_xlsx()</span></code></a>.</p>
<p>This is a simple example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dstream_excel</span> <span class="k">import</span> <span class="n">download_datastream</span>

<span class="n">download_datastream</span><span class="p">(</span>
    <span class="s1">&#39;output_folder&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;@AAPL&#39;</span><span class="p">,</span><span class="s1">&#39;@MSFT&#39;</span><span class="p">],</span>  <span class="c1"># Datastream-style tickers</span>
    <span class="p">[</span><span class="s1">&#39;UP&#39;</span><span class="p">,</span> <span class="s1">&#39;RI&#39;</span><span class="p">,</span> <span class="s1">&#39;NOSH&#39;</span><span class="p">,</span> <span class="s1">&#39;VO&#39;</span><span class="p">],</span>  <span class="c1"># Variable names from Datastream</span>
    <span class="n">outpath</span><span class="o">=</span><span class="s1">&#39;data.csv&#39;</span><span class="p">,</span>
    <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span>
    <span class="n">begin</span><span class="o">=</span><span class="s1">&#39;-1Y&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You may see errors relating to calling Excel and that Excel has been terminated.
There is retry logic built into the package as Excel does not respond very
consistently in this way, so Excel may be terminated and restarted many
times in the process of downloading.</p>
<p>A <cite>failed</cite> folder will be created and any XLSX that were unable
to pull data after several retries will be moved here so that they can be
re-run later.</p>
</div>
<div class="section" id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<p>Hopefully the <a class="reference internal" href="api/dstream_excel.html#dstream_excel.main.download_datastream" title="dstream_excel.main.download_datastream"><code class="xref py py-func docutils literal notranslate"><span class="pre">download_datastream()</span></code></a> function works end-to-end. But
the second step where the files populated may cause Excel to fail. There is
some logic in the package to keep restarting Excel, but this may eventually
fail as well. If this happens, get your Excel working manually again (may
require a restart or re-enabling the Eikon plugin), then you can run
<a class="reference internal" href="api/dstream_excel.dstream.html#dstream_excel.dstream.downloader.populate_all_files_in_folder" title="dstream_excel.dstream.downloader.populate_all_files_in_folder"><code class="xref py py-func docutils literal notranslate"><span class="pre">populate_all_files_in_folder()</span></code></a> while passing <cite>restart=False</cite> to
continue where it left off. Repeat this as many times as needed, then at
the end you can run <a class="reference internal" href="api/dstream_excel.dstream.html#dstream_excel.dstream.combine.combine_all_datastream_xlsx" title="dstream_excel.dstream.combine.combine_all_datastream_xlsx"><code class="xref py py-func docutils literal notranslate"><span class="pre">combine_all_datastream_xlsx()</span></code></a>.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dstream_excel</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">populate_all_files_in_folder</span><span class="p">,</span>
    <span class="n">combine_all_datastream_xlsx</span>
<span class="p">)</span>

<span class="c1"># Run as many times as needed, fixing Excel in between</span>
<span class="n">populate_all_files_in_folder</span><span class="p">(</span>
    <span class="s1">&#39;output_folder&#39;</span><span class="p">,</span>
    <span class="n">restart</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Once populate can actually finish, then run this</span>
<span class="n">combine_all_datastream_xlsx</span><span class="p">(</span>
    <span class="s1">&#39;output_folder&#39;</span><span class="p">,</span>
    <span class="n">outpath</span><span class="o">=</span><span class="s1">&#39;data.csv&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting started with dstream_excel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#install">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">dstream_excel</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to Datastream Python Excel Downloader Documentation!</a></li>
      <li>Next: <a href="api/modules.html" title="next chapter">dstream_excel</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Nick DeRobertis.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/tutorial.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>